---
layout: advisory
title: 'CVE-2017-1000043 (mapbox-rails): mapbox-rails Content Injection via TileJSON
  Name'
comments: false
categories:
- mapbox-rails
advisory:
  gem: mapbox-rails
  cve: 2017-1000043
  osvdb: 132871
  ghsa: q69p-5h74-w36f
  url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000043
  title: mapbox-rails Content Injection via TileJSON Name
  date: 2016-01-12
  description: |
    Mapbox.js versions 1.x prior to 1.6.6 and 2.x prior to 2.2.4 are vulnerable
    to a cross-site-scripting attack in certain uncommon usage scenarios.

    If you use L.mapbox.map and L.mapbox.shareControl it is possible for a
    malicious user with control over the TileJSON content to inject script
    content into the name value of the TileJSON. After clicking on the share
    control, the malicious code will execute in the context of the page using
    Mapbox.js.

    Such usage is uncommon. L.mapbox.shareControl is not automatically added to
    Mapbox.js maps and must be explicitly added. The following usage scenarios
    are not vulnerable:

    * the map does not use a share control (L.mapbox.sharecontrol)
    * only trusted TileJSON content is loaded
  cvss_v2: 4.3
  cvss_v3: 6.1
  patched_versions:
  - "~> 1.6.6"
  - ">= 2.2.4"
  related:
    url:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-1000043
    - https://nodesecurity.io/advisories/74
    - https://hackerone.com/reports/99245
    - https://github.com/advisories/GHSA-q69p-5h74-w36f
---
