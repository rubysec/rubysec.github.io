---
layout: advisory
title: 'CVE-2020-7663 (websocket-extensions): Regular Expression Denial of Service
  in websocket-extensions (RubyGem)'
comments: false
categories:
- websocket-extensions
advisory:
  gem: websocket-extensions
  cve: 2020-7663
  ghsa: g6wq-qcwm-j5g2
  url: https://github.com/faye/websocket-extensions-ruby/security/advisories/GHSA-g6wq-qcwm-j5g2
  date: 2020-06-05
  title: Regular Expression Denial of Service in websocket-extensions (RubyGem)
  description: |
    ### Impact

    The ReDoS flaw allows an attacker to exhaust the server's capacity to process
    incoming requests by sending a WebSocket handshake request containing a header
    of the following form:

        Sec-WebSocket-Extensions: a; b="\c\c\c\c\c\c\c\c\c\c ...

    That is, a header containing an unclosed string parameter value whose content is
    a repeating two-byte sequence of a backslash and some other character. The
    parser takes exponential time to reject this header as invalid, and this will
    block the processing of any other work on the same thread. Thus if you are
    running a single-threaded server, such a request can render your service
    completely unavailable.

    ### Workarounds

    There are no known work-arounds other than disabling any public-facing WebSocket functionality you are operating.
  cvss_v3: 7.5
  patched_versions:
  - ">= 0.1.5"
  related:
    url:
    - https://blog.jcoglan.com/2020/06/02/redos-vulnerability-in-websocket-extensions/
---
