---
layout: advisory
title: 'CVE-2022-29181 (nokogiri): Improper Handling of Unexpected Data Type in Nokogiri'
comments: false
categories:
- nokogiri
advisory:
  gem: nokogiri
  cve: 2022-29181
  ghsa: xh29-r2w5-wx8m
  url: https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-xh29-r2w5-wx8m
  title: Improper Handling of Unexpected Data Type in Nokogiri
  date: 2022-05-23
  description: |
    ### Summary

    Nokogiri `< v1.13.6` does not type-check all inputs into the XML and HTML4 SAX parsers.
    For CRuby users, this may allow specially crafted untrusted inputs to cause illegal
    memory access errors (segfault) or reads from unrelated memory.

    ### Severity

    The Nokogiri maintainers have evaluated this as **High 8.2** (CVSS3.1).

    ### Mitigation

    CRuby users should upgrade to Nokogiri `>= 1.13.6`.

    JRuby users are not affected.

    ### Workarounds

    To avoid this vulnerability in affected applications, ensure the untrusted input is a
    `String` by calling `#to_s` or equivalent.
  cvss_v3: 8.2
  patched_versions:
  - ">= 1.13.6"
  related:
    url:
    - https://github.com/sparklemotion/nokogiri/commit/db05ba9a1bd4b90aa6c76742cf6102a7c7297267
    - https://github.com/sparklemotion/nokogiri/releases/tag/v1.13.6
    - https://securitylab.github.com/advisories/GHSL-2022-031_GHSL-2022-032_Nokogiri/
---
