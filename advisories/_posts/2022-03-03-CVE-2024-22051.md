---
layout: advisory
title: 'CVE-2024-22051 (commonmarker): Integer overflow in cmark-gfm table parsing
  extension leads to heap memory corruption'
comments: false
categories:
- commonmarker
advisory:
  gem: commonmarker
  cve: 2024-22051
  ghsa: fmx4-26r3-wxpf
  url: https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x
  title: Integer overflow in cmark-gfm table parsing extension leads to heap memory
    corruption
  date: 2022-03-03
  description: |2

    ### Impact

    CommonMarker uses `cmark-gfm` for rendering
    [Github Flavored Markdown](https://github.github.com/gfm/).
    An [integer overflow in `cmark-gfm`'s table row parsing](https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x)
    may lead to heap memory corruption when parsing tables who's marker
    rows contain more than UINT16_MAX columns. The impact of this heap
    corruption ranges from Information Leak to Arbitrary Code Execution.

    If affected versions of CommonMarker are used for rendering remote
    user controlled markdown, this vulnerability may lead to
    Remote Code Execution (RCE).

    ### Patches

    This vulnerability has been patched in the following CommonMarker release:

    - v0.23.4

    ### Workarounds

    The vulnerability exists in the table markdown extensions of
    `cmark-gfm`. Disabling any use of the table extension will prevent
    this vulnerability from being triggered.

    ### References

    - https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x

    ### Acknowledgements

    We would like to thank Felix Wilhelm of Google's Project Zero
    for reporting this vulnerability

    ### For more information

    If you have any questions or comments about this advisory:

    * Open an issue in [CommonMarker](http://github.com/gjtorikian/commonmarker)
  cvss_v3: 8.8
  patched_versions:
  - ">= 0.23.4"
  related:
    url:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-22051
    - https://github.com/github/cmark-gfm/security/advisories/GHSA-mc3g-88wq-6f4x
    - https://github.com/gjtorikian/commonmarker/security/advisories/GHSA-fmx4-26r3-wxpf
    - https://github.com/gjtorikian/commonmarker/commit/ab4504fd17460627a6ab255bc3c63e8e5fc6aed3
    - https://github.com/advisories/GHSA-fmx4-26r3-wxpf
---
