---
layout: advisory
title: 'CVE-2011-3187 (actionpack): Ruby on rails 3.0.5 Remote_IP.rb Input Validation
  in rails/actionpack'
comments: false
categories:
- actionpack
- rails
advisory:
  gem: actionpack
  framework: rails
  cve: 2011-3187
  ghsa: 3vfw-7rcp-3xgm
  url: http://webservsec.blogspot.com/2011/02/ruby-on-rails-vulnerability.html
  title: Ruby on rails 3.0.5 Remote_IP.rb Input Validation in rails/actionpack
  date: 2017-10-24
  description: |
    The to_s method in actionpack/lib/action_dispatch/middleware/remote_ip.rb
    in Ruby on Rails 3.0.5 does not validate the X-Forwarded-For header
    in requests from IP addresses on a Class C network, which might allow
    remote attackers to inject arbitrary text into log files or bypass
    intended address parsing via a crafted header.
  cvss_v2: 4.3
  unaffected_versions:
  - "< 2.3.0"
  patched_versions:
  - ">= 2.3.13"
  related:
    url:
    - https://nvd.nist.gov/vuln/detail/CVE-2011-3187
    - http://webservsec.blogspot.com/2011/02/ruby-on-rails-vulnerability.html
    - https://github.com/advisories/GHSA-3vfw-7rcp-3xgm
    - https://www.rapid7.com/db/vulnerabilities/ruby_on_rails-cve-2011-3187
    - http://www.openwall.com/lists/oss-security/2011/08/17/1
    - http://www.openwall.com/lists/oss-security/2011/08/19/11
    - http://www.openwall.com/lists/oss-security/2011/08/20/1
    - http://www.openwall.com/lists/oss-security/2011/08/22/13
    - http://www.openwall.com/lists/oss-security/2011/08/22/14
    - http://www.openwall.com/lists/oss-security/2011/08/22/5
    - https://web.archive.org/web/20111209181000/http://archives.neohapsis.com/archives/fulldisclosure/2011-02/0337.html
---
