---
layout: advisory
title: 'CVE-2024-22191 (avo): avo vulnerable to stored cross-site scripting (XSS)
  in key_value field'
comments: false
categories:
- avo
advisory:
  gem: avo
  cve: 2024-22191
  ghsa: ghjv-mh6x-7q6h
  url: https://github.com/avo-hq/avo/security/advisories/GHSA-ghjv-mh6x-7q6h
  title: avo vulnerable to stored cross-site scripting (XSS) in key_value field
  date: 2024-01-16
  description: |2

    ### Summary

    A **stored cross-site scripting (XSS)** vulnerability was found in
    the **key_value** field of Avo v3.2.3. This vulnerability could allow
    an attacker to execute arbitrary JavaScript code in the victim's browser.

    ### Details

    The value of the key_value is inserted directly into the HTML code.
    In the current version of Avo (possibly also older versions), the
    value is not properly sanitized before it is inserted into the HTML code.

    This vulnerability can be exploited by an attacker to inject malicious
    JavaScript code into the key_value field. When a victim views the page
    containing the malicious code, the code will be executed in their browser.

    In [avo/fields/common/key_value_component.html.erb](https://github.com/avo-hq/avo/blob/main/app/components/avo/fields/common/key_value_component.html.erb#L38C21-L38C33)
    the value is taken in lines **38** and **49** and seems to be
    interpreted directly as html in lines **44** and **55**.

    ### Impact

    This vulnerability could be used to steal sensitive information from
    victims that could be used to hijack victims' accounts or redirect
    them to malicious websites.
  cvss_v3: 7.3
  patched_versions:
  - ">= 3.2.4"
  - "~> 2.47, >= 2.47"
  related:
    url:
    - https://github.com/avo-hq/avo/security/advisories/GHSA-ghjv-mh6x-7q6h
    - https://github.com/avo-hq/avo/commit/51bb80b181cd8e31744bdc4e7f9b501c81172347
    - https://github.com/avo-hq/avo/commit/fc92a05a8556b1787c8694643286a1afa6a71258
    - https://github.com/advisories/GHSA-ghjv-mh6x-7q6h
---
