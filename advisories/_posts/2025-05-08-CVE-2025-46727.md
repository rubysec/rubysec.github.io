---
layout: advisory
title: 'CVE-2025-46727 (rack): Rack has an Unbounded-Parameter DoS in Rack::QueryParser'
comments: false
categories:
- rack
advisory:
  gem: rack
  cve: 2025-46727
  ghsa: gjh7-p2fx-99vx
  url: https://github.com/rack/rack/security/advisories/GHSA-gjh7-p2fx-99vx
  title: Rack has an Unbounded-Parameter DoS in Rack::QueryParser
  date: 2025-05-08
  description: |
    ## Summary

    `Rack::QueryParser` parses query strings and
    `application/x-www-form-urlencoded` bodies into Ruby data structures
    without imposing any limit on the number of parameters, allowing
    attackers to send requests with extremely large numbers of parameters.

    ## Details

    The vulnerability arises because `Rack::QueryParser` iterates over
    each `&`-separated key-value pair and adds it to a Hash without
    enforcing an upper bound on the total number of parameters. This
    allows an attacker to send a single request containing hundreds of
    thousands (or more) of parameters, which consumes excessive memory
    and CPU during parsing.

    ## Impact

    An attacker can trigger denial of service by sending specifically
    crafted HTTP requests, which can cause memory exhaustion or pin CPU
    resources, stalling or crashing the Rack server. This results in
    full service disruption until the affected worker is restarted.

    ## Mitigation

    - Update to a version of Rack that limits the number of parameters parsed, or
    - Use middleware to enforce a maximum query string size or parameter count, or
    - Employ a reverse proxy (such as Nginx) to limit request sizes and
      reject oversized query strings or bodies.

    Limiting request body sizes and query string lengths at the web
    server or CDN level is an effective mitigation.
  cvss_v3: 7.5
  patched_versions:
  - "~> 2.2.14"
  - "~> 3.0.16"
  - ">= 3.1.14"
  related:
    url:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-46727
    - https://github.com/rack/rack/security/advisories/GHSA-gjh7-p2fx-99vx
    - https://github.com/rack/rack/commit/2bb5263b464b65ba4b648996a579dbd180d2b712
    - https://github.com/rack/rack/commit/3f5a4249118d09d199fe480466c8c6717e43b6e3
    - https://github.com/rack/rack/commit/cd6b70a1f2a1016b73dc906f924869f4902c2d74
    - https://github.com/advisories/GHSA-gjh7-p2fx-99vx
---
