---
layout: advisory
title: 'CVE-2021-3517 (nokogiri): Nokogiri contains libxml Out-of-bounds Write vulnerability'
comments: false
categories:
- nokogiri
advisory:
  gem: nokogiri
  cve: 2021-3517
  ghsa: jw9f-hh49-cvp9
  url: https://bugzilla.redhat.com/show_bug.cgi?id=1954232
  title: Nokogiri contains libxml Out-of-bounds Write vulnerability
  date: 2022-05-24
  description: |-
    There is a flaw in the xml entity encoding functionality of libxml2 in versions before 2.9.11. An attacker who is able to supply a crafted file to be processed by an application linked with the affected functionality of libxml2 could trigger an out-of-bounds read. The most likely impact of this flaw is to application availability, with some potential impact to confidentiality and integrity if an attacker is able to use memory information to further exploit the application.

    Nokogiri prior to version 1.11.4 used a vulnerable version of libxml2. Nokogiri 1.11.4 updated libxml2 to version 2.9.11 to address this and other vulnerabilities in libxml2.
  cvss_v3: 8.6
  patched_versions:
  - ">= 1.11.4"
  related:
    url:
    - https://lists.apache.org/thread.html/r58af02e294bd07f487e2c64ffc0a29b837db5600e33b6e698b9d696b@%3Cissues.bookkeeper.apache.org%3E
    - https://lists.apache.org/thread.html/rf4c02775860db415b4955778a131c2795223f61cb8c6a450893651e4@%3Cissues.bookkeeper.apache.org%3E
    - https://lists.debian.org/debian-lts-announce/2021/05/msg00008.html
    - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BZOMV5J4PMZAORVT64BKLV6YIZAFDGX6/
    - https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QVM4UJ3376I6ZVOYMHBNX4GY3NIV52WV/
    - https://security.gentoo.org/glsa/202107-05
    - https://security.netapp.com/advisory/ntap-20210625-0002/
    - https://security.netapp.com/advisory/ntap-20211022-0004/
    - https://www.oracle.com/security-alerts/cpuapr2022.html
    - https://www.oracle.com/security-alerts/cpujan2022.html
    - https://www.oracle.com/security-alerts/cpuoct2021.html
    - https://www.oracle.com/security-alerts/cpujul2022.html
    - https://github.com/sparklemotion/nokogiri/issues/2233
    - https://github.com/sparklemotion/nokogiri/issues/2274
    - https://github.com/sparklemotion/nokogiri/blob/7c19ef5cc6b7c5c36827dd5495f857c6877ec8cf/CHANGELOG.md?plain=1#L579
    - https://gitlab.gnome.org/GNOME/libxml2/-/commit/8598060bacada41a0eb09d95c97744ff4e428f8e
---
