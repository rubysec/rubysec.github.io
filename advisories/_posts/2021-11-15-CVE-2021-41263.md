---
layout: advisory
title: 'CVE-2021-41263 (rails_multisite): Secure/signed cookies share secrets between
  sites in a multi-site application'
comments: false
categories:
- rails_multisite
advisory:
  gem: rails_multisite
  cve: 2021-41263
  ghsa: 844m-cpr9-jcmh
  url: https://github.com/discourse/rails_multisite/security/advisories/GHSA-844m-cpr9-jcmh
  title: Secure/signed cookies share secrets between sites in a multi-site application
  date: 2021-11-15
  description: |
    ### Impact
    This vulnerability impacts any Rails applications using `rails_multisite` alongside Rails' signed/encrypted cookies. Depending on how the application makes use of these cookies, it may be possible for an attacker to re-use cookies on different 'sites' within a multi-site Rails application.

    ### Patches
    The issue has been patched in v4 of the `rails_multisite` gem. Note that this upgrade will invalidate all previous signed/encrypted cookies. The impact of this invalidation will vary based on the application architecture.
  cvss_v3: 6.2
  patched_versions:
  - ">= 4.0.0"
---
