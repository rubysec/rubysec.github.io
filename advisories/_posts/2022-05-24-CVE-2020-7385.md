---
layout: advisory
title: 'CVE-2020-7385 (metasploit-framework): Metasploit Framework user exposes Metasploit
  to same deserialization issue that is exploited by that module'
comments: false
categories:
- metasploit-framework
advisory:
  gem: metasploit-framework
  cve: 2020-7385
  ghsa: xgww-h98f-24qf
  url: https://github.com/rapid7/metasploit-framework/pull/14300
  title: Metasploit Framework user exposes Metasploit to same deserialization issue
    that is exploited by that module
  date: 2022-05-24
  description: |
    By launching the drb_remote_codeexec exploit, a Metasploit Framework
    user will inadvertently expose Metasploit to the same deserialization issue that
    is exploited by that module, due to the reliance on the vulnerable Distributed Ruby
    class functions. Since Metasploit Framework typically runs with elevated privileges,
    this can lead to a system compromise on the Metasploit workstation. Note that an
    attacker would have to lie in wait and entice the Metasploit user to run the affected
    module against a malicious endpoint in a "hack-back" type of attack. Metasploit
    is only vulnerable when the drb_remote_codeexec module is running. In most cases,
    this cannot happen automatically.
  cvss_v3: 8.1
  patched_versions:
  - ">= 4.19.0"
  related:
    url:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-7385
    - https://github.com/rapid7/metasploit-framework/pull/14300
    - https://github.com/rapid7/metasploit-framework/pull/14335
    - https://help.rapid7.com/metasploit/release-notes/archive/2020/10/
    - https://github.com/advisories/GHSA-xgww-h98f-24qf
---
